<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="google-signin-client_id"
        content="1001337791389-6ege8sgdvjmrhemv0nk7r6bnl781e2i4.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script type="text/javascript" src="testingapi.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body>
    <h1>This is a great site</h1>
    <p>
        <a href="Secondpage.html">Click here</a>
    </p>

    <h1>Get Weather</h1>
    <button onclick="getWeather()">Get Weather</button>
    <p id="weather"></p>
    <div class="allWeather">
        <div class="weatherBlock">
            <p id="time1"></p>
            <img id="weatherimg1" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp1"></p>
            <p id="weather1">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time2"></p>
            <img id="weatherimg2" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp2"></p>
            <p id="weather2">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time3"></p>
            <img id="weatherimg3" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp3"></p>
            <p id="weather3">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time4"></p>
            <img id="weatherimg4" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp4"></p>
            <p id="weather4">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time5"></p>
            <img id="weatherimg5" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp5"></p>
            <p id="weather5">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time6"></p>
            <img id="weatherimg6" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp6"></p>
            <p id="weather6">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time7"></p>
            <img id="weatherimg7" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp7"></p>
            <p id="weather7">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time8"></p>
            <img id="weatherimg8" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp8"></p>
            <p id="weather8">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time9"></p>
            <img id="weatherimg9" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp9"></p>
            <p id="weather9">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time10"></p>
            <img id="weatherimg10" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp10"></p>
            <p id="weather10">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time11"></p>
            <img id="weatherimg11" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp11"></p>
            <p id="weather11">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time12"></p>
            <img id="weatherimg12" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp12"></p>
            <p id="weather12">It is sunny today</p>
        </div>
    </div>

    <script>
        function getWeather() {
            const apiKey = 'yiVAx0WsTqB1wLo5s0WYChEHnfwK92Be';
            const locationKey = '2089870';
            const apiUrl = `https://cors-anywhere.herokuapp.com/https://dataservice.accuweather.com/forecasts/v1/hourly/12hour/${locationKey}?apikey=${apiKey}`;


            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {



                    for (var i = 0; i < 12; i++) {

                        var time = data[i].DateTime;
                        var newTime = time.substring(11, 13);


                        // Convert military time to integer
                        var hours = parseInt(newTime);

                        // Determine AM or PM
                        var ampm = (hours < 12) ? "AM" : "PM";

                        // Convert hours to standard time
                        hours = (hours > 12) ? hours - 12 : hours;
                        hours = (hours == 0) ? 12 : hours;

                        // Return formatted time string
                        var finalTime = hours + " " + ampm;

                        document.getElementById("time" + (i + 1)).innerHTML = finalTime;

                        var weatherIconNum = data[i].WeatherIcon;
                        if (weatherIconNum < 10) {
                            weatherIconNum = "0" + weatherIconNum;
                        }

                        var imageNum = "https://developer.accuweather.com/sites/default/files/" + weatherIconNum + "-s.png"

                        document.getElementById("weatherimg" + (i + 1)).setAttribute("src", imageNum);

                        document.getElementById("temp" + (i + 1)).innerHTML = data[i].Temperature.Value + "Â° F";

                        if (data[i].HasPrecipitation == true) {
                            document.getElementById("weather" + (i + 1)).innerHTML = data[i].PrecipitationIntensity + " " + data[i].PrecipitationType;
                        } else if (data[i].HasPrecipitation == false) {
                            document.getElementById("weather" + (i + 1)).innerHTML = data[i].IconPhrase;
                        } else {

                        }

                    }
                })
                .catch(error => console.error(error));
        }

    </script>

    <div class="bottomStuff">
        <br>
        <button type="button" id="redirectButton">Click me</button>

        <div class="g-signin2" data-onsuccess="onSignIn"></div>

        <a href="#" onclick="signOut();">Sign out</a>
        <script>
            function signOut() {
                if (typeof gapi !== 'undefined') {
                    var auth2 = gapi.auth2.getAuthInstance();
                    auth2.signOut().then(function () {
                        console.log('User signed out.');
                    });
                } else {
                    console.log('Google API library not loaded.');
                }
            }

        </script>

    </div>
</body>

</html>