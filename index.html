<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="google-signin-client_id"
        content="1001337791389-6ege8sgdvjmrhemv0nk7r6bnl781e2i4.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script type="text/javascript" src="testingapi.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body>
    <h1>This is a great site</h1>
    <p>
        <a href="Secondpage.html">Click here</a>
    </p>

    <h1>Get Weather</h1>
    <button onclick="getWeather()">Get Weather</button>
    <p id="weather"></p>
    <div class="allWeather">
        <div class="weatherBlock">
            <p id="time1"></p>
            <img id="weatherimg1" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp1"></p>
            <p id="weather1">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time2"></p>
            <img id="weatherimg2" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp2"></p>
            <p id="weather2">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time3"></p>
            <img id="weatherimg3" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp3"></p>
            <p id="weather3">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time4"></p>
            <img id="weatherimg4" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp4"></p>
            <p id="weather4">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time5"></p>
            <img id="weatherimg5" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp5"></p>
            <p id="weather5">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time6"></p>
            <img id="weatherimg6" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp6"></p>
            <p id="weather6">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time7"></p>
            <img id="weatherimg7" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp7"></p>
            <p id="weather7">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time8"></p>
            <img id="weatherimg8" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp8"></p>
            <p id="weather8">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time9"></p>
            <img id="weatherimg9" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp9"></p>
            <p id="weather9">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time10"></p>
            <img id="weatherimg10" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp10"></p>
            <p id="weather10">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time11"></p>
            <img id="weatherimg11" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp11"></p>
            <p id="weather11">It is sunny today</p>
        </div>
        <div class="weatherBlock">
            <p id="time12"></p>
            <img id="weatherimg12" src="https://developer.accuweather.com/sites/default/files/01-s.png" />
            <p id="temp12"></p>
            <p id="weather12">It is sunny today</p>
        </div>
    </div>

    <script>
        function getWeather() {
            const apiKey = 'kGNyWQ9e1ASq0BGTVXtrqHcEpRaRIAcW';
            const locationKey = '2089870';
            const apiUrl = `https://dataservice.accuweather.com/forecasts/v1/hourly/12hour/${locationKey}?apikey=${apiKey}`;
            var image1 = "https://developer.accuweather.com/sites/default/files/01-s.png";
            var image2 = "https://developer.accuweather.com/sites/default/files/02-s.png";
            var image3 = "https://developer.accuweather.com/sites/default/files/03-s.png";
            var image4 = "https://developer.accuweather.com/sites/default/files/04-s.png";
            var image5 = "https://developer.accuweather.com/sites/default/files/05-s.png";
            var image6 = "https://developer.accuweather.com/sites/default/files/06-s.png";
            var image7 = "https://developer.accuweather.com/sites/default/files/07-s.png";
            var image8 = "https://developer.accuweather.com/sites/default/files/08-s.png";
            var image9 = "https://developer.accuweather.com/sites/default/files/09-s.png";
            var image10 = "https://developer.accuweather.com/sites/default/files/10-s.png";
            var image11 = "https://developer.accuweather.com/sites/default/files/11-s.png";
            var image12 = "https://developer.accuweather.com/sites/default/files/12-s.png";
            var image13 = "https://developer.accuweather.com/sites/default/files/13-s.png";
            var image14 = "https://developer.accuweather.com/sites/default/files/14-s.png";
            var image15 = "https://developer.accuweather.com/sites/default/files/15-s.png";
            var image16 = "https://developer.accuweather.com/sites/default/files/16-s.png";
            var image17 = "https://developer.accuweather.com/sites/default/files/17-s.png";
            var image18 = "https://developer.accuweather.com/sites/default/files/18-s.png";
            var image19 = "https://developer.accuweather.com/sites/default/files/19-s.png";
            var image20 = "https://developer.accuweather.com/sites/default/files/20-s.png";
            var image21 = "https://developer.accuweather.com/sites/default/files/21-s.png";
            var image22 = "https://developer.accuweather.com/sites/default/files/22-s.png";
            var image23 = "https://developer.accuweather.com/sites/default/files/23-s.png";
            var image24 = "https://developer.accuweather.com/sites/default/files/24-s.png";
            var image25 = "https://developer.accuweather.com/sites/default/files/25-s.png";
            var image26 = "https://developer.accuweather.com/sites/default/files/26-s.png";
            var image27 = "https://developer.accuweather.com/sites/default/files/27-s.png";
            var image28 = "https://developer.accuweather.com/sites/default/files/28-s.png";
            var image29 = "https://developer.accuweather.com/sites/default/files/29-s.png";
            var image30 = "https://developer.accuweather.com/sites/default/files/30-s.png";
            var image31 = "https://developer.accuweather.com/sites/default/files/31-s.png";
            var image32 = "https://developer.accuweather.com/sites/default/files/32-s.png";
            var image33 = "https://developer.accuweather.com/sites/default/files/33-s.png";
            var image34 = "https://developer.accuweather.com/sites/default/files/34-s.png";
            var image35 = "https://developer.accuweather.com/sites/default/files/35-s.png";
            var image36 = "https://developer.accuweather.com/sites/default/files/36-s.png";
            var image37 = "https://developer.accuweather.com/sites/default/files/37-s.png";
            var image38 = "https://developer.accuweather.com/sites/default/files/38-s.png";
            var image39 = "https://developer.accuweather.com/sites/default/files/39-s.png";
            var image40 = "https://developer.accuweather.com/sites/default/files/40-s.png";
            var image41 = "https://developer.accuweather.com/sites/default/files/41-s.png";
            var image42 = "https://developer.accuweather.com/sites/default/files/42-s.png";
            var image43 = "https://developer.accuweather.com/sites/default/files/43-s.png";
            var image44 = "https://developer.accuweather.com/sites/default/files/44-s.png";

            const images = [image1, image2, image3, image4, image5, image6, image7, image8, image9, image10, image11, image12, image13,
                image14, image15, image16, image17, image18, image19, image20, image21, image22, image23, image24, image25, image26, image27,
                image28, image29, image30, image31, image32, image33, image34, image35, image36, image38, image39, image40,
                image41, image42, image43, image44];


            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {

                    for (var i = 0; i <= 12; i++) {
                        var orginalTime = data[i].DateTime;
                        var newTime = orginalTime.substring(11, 13);
                        var timeString = data[i].DateTime + " is the time";

                        // Convert military time to integer
                        var hours = parseInt(newTime);

                        // Determine AM or PM
                        var ampm = (hours < 12) ? "AM" : "PM";

                        // Convert hours to standard time
                        hours = (hours > 12) ? hours - 12 : hours;
                        hours = (hours == 0) ? 12 : hours;

                        // Return formatted time string
                        var finalTime=  hours + " " + ampm;

                        document.getElementById("time" + (i + 1)).innerHTML = finalTime;
                        document.getElementById("temp" + (i + 1)).innerHTML = data[i].Temperature.Value + "° F";
                        if(data[i].HasPrecipitation == true){
                            document.getElementById("weather" + (i + 1)).innerHTML = data[i].PrecipitationIntensity + " " + data[i].PrecipitationType;
                        }else if(data[i].HasPrecipitation == false){
                            document.getElementById("weather" + (i + 1)).innerHTML = data[i].IconPhrase;
                        }
                    }



                    // console.log(data[0].Temperature.Value);
                    var weatherIcon1 = data[0].WeatherIcon;
                    weatherIcon1 = weatherIcon1 - 1;
                    //console.log(weatherIcon1);
                    //console.log(images[weatherIcon1]);
                    var weatherIcon2 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;
                    var weatherIcon1 = data[0].WeatherIcon;

                    document.getElementById("weatherimg1").setAttribute("src", (images[data[0].WeatherIcon - 1]));
                    document.getElementById("weatherimg2").setAttribute("src", (images[data[1].WeatherIcon - 1]));
                    document.getElementById("weatherimg3").setAttribute("src", (images[data[2].WeatherIcon - 1]));
                    document.getElementById("weatherimg4").setAttribute("src", (images[data[3].WeatherIcon - 1]));
                    document.getElementById("weatherimg5").setAttribute("src", (images[data[4].WeatherIcon - 1]));
                    document.getElementById("weatherimg6").setAttribute("src", (images[data[5].WeatherIcon - 1]));
                    document.getElementById("weatherimg7").setAttribute("src", (images[data[6].WeatherIcon - 1]));
                    document.getElementById("weatherimg8").setAttribute("src", (images[data[7].WeatherIcon - 1]));
                    document.getElementById("weatherimg9").setAttribute("src", (images[data[8].WeatherIcon - 1]));
                    document.getElementById("weatherimg10").setAttribute("src", (images[data[9].WeatherIcon - 1]));
                    document.getElementById("weatherimg11").setAttribute("src", (images[data[10].WeatherIcon - 1]));
                    document.getElementById("weatherimg12").setAttribute("src", (images[data[11].WeatherIcon - 1]));

                    //console.log(data[11].WeatherIcon);
                    /*
                    const weatherInfo = data[0];
                    const temperature1 = weatherInfo.Temperature.Imperial.Value;
                    const weatherText1 = weatherInfo.WeatherText;

                    const weatherInfoElement = document.getElementById("weather');
                    if (weatherInfoElement !== null) {
                        weatherInfoElement.textContent = `The temperature is ${temperature} degrees Fahrenheit and the weather is ${weatherText}.`;
                    }
                    */
                })
                .catch(error => console.error(error));
        }

        /*DONT TOUCH
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                const weatherInfo = data[0];
                const temperature = weatherInfo.Temperature.Imperial.Value;
                const weatherText = weatherInfo.WeatherText;

                const weatherInfoElement = document.getElementById('weather');
                if (weatherInfoElement !== null) {
                    weatherInfoElement.textContent = `The temperature is ${temperature} degrees Fahrenheit and the weather is ${weatherText}.`;
                }
            })
            .catch(error => console.error(error));
            */

    </script>

    <div class="bottomStuff">
        <br>
        <button type="button" id="redirectButton">Click me</button>

        <div class="g-signin2" data-onsuccess="onSignIn"></div>

        <a href="#" onclick="signOut();">Sign out</a>
        <script>
            function signOut() {
                if (typeof gapi !== 'undefined') {
                    var auth2 = gapi.auth2.getAuthInstance();
                    auth2.signOut().then(function () {
                        console.log('User signed out.');
                    });
                } else {
                    console.log('Google API library not loaded.');
                }
            }

        </script>

    </div>
</body>

</html>